K_SON: ; LECTURA DE TECLADO PARA S O N
    LD C, $FE
KSON_BUCLE: 
    LD B, $FD
    IN A, (C)
    BIT 1, A
    JR Z, KSON_S

    LD B, $7F
    IN A, (C)
    BIT 3, A
    JR Z, KSON_N

    JR NZ, KSON_BUCLE

KSON_N:
    LD D, "N"
    JR KSON_RELEASE

KSON_S:
    LD D, "S"

KSON_RELEASE:
    IN A, (C)
    AND $1F
    CP $1F
    JR NZ, KSON_RELEASE

    RET ; FIN DE KSON


K_LR_ENTER_F: ; LECTURA DE TECLADO PARA Q (LEFT) W (RIGHT) O ENTER (SOLTAR FICHA)
    LD C, $FE

KLREF_BUCLE: 
    LD B, $FB
    IN A, (C)
    BIT 0, A
    JR Z, KLREF_Q
    BIT 1, A
    JR Z, KLREF_W

    LD B, $BF
    IN A, (C)
    BIT 0, A
    JR Z, KLREF_ENTER

    LD B, $FD
    IN A, (C)
    BIT 3, A
    JR Z, KLREF_F

    JR KLREF_BUCLE

KLREF_Q:
    LD D, 'Q'

KLREF_RELEASE_QW:
    LD B, $FB
    IN A, (C)
    AND $1F
    CP $1F
    JR NZ, KLREF_RELEASE_QW
    RET

KLREF_W:
    LD D, 'W'
    JR KLREF_RELEASE_QW

KLREF_ENTER:
    LD D, 13 ; ASCII PARA ENTER EN ZXSPECTRUM48

KLREF_RELEASE_ENTER:
    LD B, $BF
    IN A, (C)
    AND $1F
    CP $1F
    JR NZ, KLREF_RELEASE_ENTER
    RET ; FIN DE LECTURA Q W ENTER

KLREF_F:
    LD D, 'F'

KLREF_RELEASE_F:
    LD B, $FD
    IN A, (C)
    AND $1F
    CP $1F
    JR NZ, KLREF_RELEASE_F
    RET